"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[500],{65500:function(e,t,i){i.r(t),i.d(t,{GooglelocatorInit:function(){return s}});var o=i(77302),n=i(52390);/*!
 * Xtend UI (https://xtendui.com/)
 * @copyright (c) 2017-2025 Riccardo Caroli
 * @license MIT (https://github.com/xtendui/xtendui/blob/master/LICENSE.txt)
 */class s{_init(){this._initVars(),this._initLogic()}_initVars(){this._optionsDefault=o.Xt.merge([this.constructor.optionsDefault,o.Xt.options[this.componentName]]),this._optionsInitial=this.options=o.Xt.merge([this._optionsDefault,this._optionsCustom])}_initLogic(){let e=this,t=e.options;e.ns=e.ns??o.Xt.uniqueId(),e.enable(),o.Xt._initMatches({self:e,optionsInitial:e._optionsInitial}),e.initial=!0,e.loaderElement=e.container.querySelector(t.elements.loader),e.itemsTemplate=e.container.querySelector(t.elements.itemsTemplate),e.itemsContainer=e.container.querySelector(t.elements.itemsContainer),e.foundElement=e.container.querySelector(t.elements.resultsFound),e.mapElement=e.container.querySelector(t.elements.map),e.map=new google.maps.Map(e.mapElement,t.map),e.searchInput=e.container.querySelector(t.elements.searchInput),e.search=new google.maps.places.Autocomplete(e.searchInput,e.options.autocompleteOptions);let i=o.Xt.dataStorage.put(e.searchInput,`keypress/${e.ns}`,e._searchSubmit.bind(e));e.searchInput.addEventListener("keypress",i),e.searchBtn=e.container.querySelector(t.elements.searchBtn);let n=o.Xt.dataStorage.put(e.searchBtn,`click/${e.ns}`,e._searchClick.bind(e));if(e.searchBtn.addEventListener("click",n),t.map.zoomMin&&google.maps.event.addListener(e.map,"zoom_changed",()=>{google.maps.event.addListener(e.map,"bounds_changed",()=>{e.map.getZoom()>t.map.zoomMin&&e.map.setZoom(t.map.zoomMin)})}),google.maps.event.addListener(e.search,"place_changed",e._placeChanged.bind(e)),t.infoWindow&&(e.info=new google.maps.InfoWindow(t.infoWindow),google.maps.event.addListener(e.info,"closeclick",e._infoClose.bind(e))),t.elements.repeatBtn&&(e.repeatElement=e.container.querySelector(t.elements.repeatBtn),e.repeatElement)){let t=o.Xt.dataStorage.put(e.repeatElement,`click/${e.ns}`,e._submitCurrent.bind(e));e.repeatElement.addEventListener("click",t)}if(t.elements.locateBtn&&(e.locateElement=e.container.querySelector(t.elements.locateBtn),e.locateElement)){if("https:"===location.protocol){if(navigator.geolocation){t.initialLocate&&e._locate({initial:!0});let i=o.Xt.dataStorage.put(e.locateElement,`click/${e.ns}`,e._locate.bind(e));e.locateElement.addEventListener("click",i)}else e.locateElement.style.display="none"}else e.locateElement.style.display="none"}e._initStart(),e.container.dispatchEvent(new CustomEvent(`setup.${e._componentNs}`)),o.Xt.frameDouble({el:e.container,ns:`${e.ns}Init`,func:()=>{e.container.setAttribute(`data-${e.componentName}-init`,""),e.container.dispatchEvent(new CustomEvent(`init.${e._componentNs}`)),e.initial=!1,t.debug&&console.debug(`${e.componentName} init`,e)}}),e.options.disabled&&e.disable()}_initStart(){let e=this,t=e.options;!e.disabled&&t.initialSearch&&google.maps.event.addListenerOnce(e.map,"idle",()=>{e.map.setCenter(t.map.center),e.map.setZoom(t.map.zoom),e._submitCurrent()})}_placeChanged(){let e=this,t=e.options;if(e.disabled)return;let i=e.search.getPlace();if(i&&i.name&&""!==i.name&&i.geometry){e.position=i.geometry.location,e.viewport=i.geometry.viewport,e.radius=t.searchRadius,e.submit();return}if(e._locateCache&&e._locateCache.value===e.searchInput.value){e.position=e._locateCache.position,e.viewport=null,e.radius=t.searchRadius,e.submit();return}if(e._predictionCache&&e._predictionCache.value===e.searchInput.value){e.position=e._predictionCache.position,e.viewport=e._predictionCache.viewport,e.radius=t.searchRadius,e.submit();return}new google.maps.places.AutocompleteService().getPlacePredictions({input:e.searchInput.value,...e.options.autocompleteServiceOptions},o=>{if(o&&o.length){let n=document.createElement("div");n.classList.add("hidden"),new google.maps.places.PlacesService(n).getDetails({reference:o[0].reference},o=>{i=o,e.searchInput.value=i.formatted_address,e.position=i.geometry.location,e.viewport=i.geometry.viewport,e.radius=t.searchRadius,e._predictionCache={value:e.searchInput.value,position:e.position,viewport:e.viewport},e.submit(),n.remove()})}else e.locations=[],e._populateItems(),e.container.classList.add("noplace"),e.container.classList.remove("empty"),e.container.classList.remove("found"),e.container.classList.remove("error")})}_infoClose(){let e=this.itemsContainer.querySelector("[data-xt-index].on");e&&o.Xt.off({el:e})}_searchSubmit(e){let t=this.options;this.disabled||"Enter"!==e.key||(e.preventDefault(),""===this.searchInput.value&&(this.map.setCenter(t.map.center),this.map.setZoom(t.map.zoom),this._submitCurrent({empty:!0})))}_searchClick(e){let t=this.options;this.disabled||(e.preventDefault(),""===this.searchInput.value?(this.map.setCenter(t.map.center),this.map.setZoom(t.map.zoom),this._submitCurrent({empty:!0})):google.maps.event.trigger(this.search,"place_changed"))}submit(){let e=this.options;this.disabled||(this._loaderShow(),setTimeout(this.submitDeferred.bind(this),e.submitDelay))}submitDeferred(){let e=this,t=e.options;if(!e.map.getBounds())return google.maps.event.addListenerOnce(e.map,"bounds_changed",()=>{e.submit()}),!1;e.filters=e.container.querySelectorAll(t.elements.filter),e.locations=[];let i=0,s=t.markers,a=new google.maps.LatLngBounds;for(let o of s)if(!e.filters.length||e._filterMarker({marker:o})){let n=new google.maps.LatLng(t.formatData.lat?t.formatData.lat(e,o):o.lat,t.formatData.lng?t.formatData.lng(e,o):o.lng),s=google.maps.geometry.spherical.computeDistanceBetween(e.position,n);if(!e.radius&&!e.viewport||e.radius&&s<=e.radius||e.viewport&&e.viewport.contains(n)){let r;let l=o.icon||t.map.icon;l&&((r=document.createElement("img")).src=l);let c=new google.maps.marker.AdvancedMarkerElement({map:e.map,position:n,title:o.name,content:r});c.animation=o.animation||t.map.animation,c.distance=s,c.marker=o,c.index=i,a.extend(n),e.locations.push(c),c.addListener("click",()=>{e._populateInfo({loc:c,type:"marker"})}),i++}}for(let[t,i]of e.locations.entries())i.index=t;t.formatData.sort(e),e._populateItems(),t.map.cluster&&(e.cluster&&e.cluster.clearMarkers(),e.cluster=new n.XL({map:e.map,markers:e.locations,...t.map.cluster})),e._loaderHide(),e.locations.length?(e.container.classList.remove("noplace"),e.container.classList.remove("empty"),e.container.classList.add("found"),e.container.classList.remove("error"),e.foundElement&&(e.foundElement.innerHTML=e.locations.length),e.map.fitBounds(a),e.map.panToBounds(a)):(e.container.classList.remove("noplace"),e.container.classList.add("empty"),e.container.classList.remove("found"),e.container.classList.remove("error"),e.viewport&&(e.map.fitBounds(e.viewport),e.map.panToBounds(e.viewport))),t.debug&&console.debug("xt-googlelocator locations",e.locations),o.Xt.frame({el:e.container,ns:`${e.ns}Change`,func:()=>{e.container.dispatchEvent(new CustomEvent(`change.${e._componentNs}`))}})}_populateItems(){for(let e of this.container.querySelectorAll(".xt-googlelocator-clone"))e.remove();for(let e of this.locations)this._populateItem({loc:e})}_filterMarker(){let{marker:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.options.formatData.filter(this,e,this.filters)}_populateItem(){let{loc:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,i=t.options,n=document.createElement("div");for(let s of(n.innerHTML=o.Xt.sanitize(t.itemsTemplate.innerHTML),(n=n.querySelector(":scope > *")).classList.add("xt-googlelocator-clone"),n.setAttribute("data-xt-index",e.index.toString()),t.itemsContainer.append(n),n.querySelectorAll("[data-xt-populate]"))){let o=i.formatData[s.getAttribute("data-xt-populate")];o&&o(t,e,s)}n.addEventListener("click",()=>{t._populateInfo({loc:e,type:"result"})})}_populateInfo(){let{loc:e,type:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this.options;this._animatingLoc&&(this._animatingLoc.setAnimation(null),this._animatingLoc=null);let n="marker"===t?i.events.animateMarkerClick:"result"===t?i.events.animateMarkerResultClick:null;n&&(e.setAnimation(n),this._animatingLoc=e);let s=this.itemsContainer.querySelector(`[data-xt-index="${e.index}"]`);if(this._infoClose(),s&&(s.focus(),o.Xt.on({el:s})),i.infoWindow){if("marker"===t?i.events.infoWindowMarkerClick:"result"===t?i.events.infoWindowMarkerResultClick:null){if(s){let t=i.formatData.info(this,e,s);t&&(this.info.setContent(t),this.info.open(this.map,e))}}else this.info.close(this.map)}}_submitCurrent(){let{empty:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.options;this.searchInput.value="",this.position=this.map.getCenter(),this.viewport=null,(!e||t.seachMapBounds)&&(this.radius=google.maps.geometry.spherical.computeDistanceBetween(this.position,this.map.getBounds().getNorthEast())),this.submit()}_locate(){let{initial:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.disabled||(e||this._loaderShow(),window.navigator.geolocation.getCurrentPosition(this._locateSuccess.bind(this),this._locateError.bind(this)))}_locateSuccess(e){let t=this.options;this._loaderHide(),this.searchInput.value=t.locateText,this.position=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),this.viewport=null,this.radius=t.searchRadius,this._locateCache={value:this.searchInput.value,position:this.position},t.debug&&console.debug("xt-googlelocator locate",e,this.position),this.map.setCenter(this.position),this.submit()}_locateError(e){this._loaderHide(),console.error("Error: Xt.Googlelocator locate error",e)}_loaderShow(){o.Xt.on({el:this.loaderElement})}_loaderHide(){o.Xt.off({el:this.loaderElement})}enable(){this.disabled&&(this.disabled=!1,this.container.dispatchEvent(new CustomEvent(`status.${this._componentNs}`)))}disable(){let{skipEvent:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.disabled||(this.disabled=!0,e||this.container.dispatchEvent(new CustomEvent(`status.${this._componentNs}`)))}reinit(){this._initLogic()}destroy(){let e=this.options,t=o.Xt.dataStorage.get(this.searchInput,`keypress/${this.ns}`);this.searchInput.removeEventListener("keypress",t);let i=o.Xt.dataStorage.get(this.searchBtn,`click/${this.ns}`);if(this.searchBtn.removeEventListener("click",i),this.locateElement){let e=o.Xt.dataStorage.get(this.locateElement,`click/${this.ns}`);this.locateElement.removeEventListener("click",e)}if(this.repeatElement){let e=o.Xt.dataStorage.get(this.repeatElement,`click/${this.ns}`);this.repeatElement.removeEventListener("click",e)}if(google.maps.event.removeListener(this.search,"place_changed",this._placeChanged.bind(this)),e.infoWindow&&google.maps.event.removeListener(this.info,"closeclick",this._infoClose.bind(this)),e.elements.locateBtn&&(this.locateElement=this.container.querySelector(e.elements.locateBtn),this.locateElement&&"https:"===location.protocol&&navigator.geolocation)){let e=o.Xt.dataStorage.put(this.locateElement,`click/${this.ns}`,this._locate.bind(this));this.locateElement.removeEventListener("click",e)}for(let e of(this.container.classList.remove("noplace"),this.container.classList.remove("empty"),this.container.classList.remove("found"),this.container.classList.remove("error"),this.container.querySelectorAll(".xt-googlelocator-clone")))e.remove();this.container.removeAttribute(`data-${this.componentName}-init`),o.Xt._remove({name:this.componentName,el:this.container}),this.container.dispatchEvent(new CustomEvent(`destroy.${this._componentNs}`)),delete this}}}}]);